<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>家居商城-登录</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="/resource/layui/css/layui.css">
    <link rel="stylesheet" href="/resource/css/index.css">
</head>
<body>
<div th:replace="mall/common/head::mall_head"></div>
<div class="layui-fulid" id="house-login">
    <div class="layui-form">
        <p>登录</p>
        <div class="layui-input-block login">
            <i class="layui-icon layui-icon-house-mobile"></i>
            <input type="text" name="phone" required lay-verify="required|phone" placeholder="请输入手机号" class="layui-input">
        </div>
        <div class="layui-input-block login">
            <i class="layui-icon">&#xe667;</i>
            <input type="password" name="password" required lay-verify="required|password" placeholder="请输入密码" class="layui-input">
<!--            <button class="layui-btn">获取验证码</button>-->
        </div>
        <button class="layui-btn" lay-submit lay-filter="doSubmit">登录</button>
    </div>
</div>
<div th:replace="/mall/common/foot::mall_foot"></div>
<script src="/resource/layui/layui.js"></script>
<script>
    layui.config({
        base: '/resource/js/'
    }).use(['house','jquery', 'form', 'element', 'layer'],function () {
        var $ = layui.jquery;
        var form = layui.form;
        var element = layui.element;
        var layer = layui.layer;
        //表单验证
        form.verify({
            phone: function(value, item){ //value：表单的值、item：表单的DOM对象
                if(!(/^1[3456789]\d{9}$/.test(value))){
                    return '手机号有误,请重新填';
                }
            }
            ,password: [
                /^[\S]{6,20}$/
                ,'密码必须6到20位，且不能出现空格'
            ]
        });

        //监听表单提交事件
        form.on("submit(doSubmit)",function (data) {
            $.post("/user/login",data.field,function(result){
                if(result.success){
                    location.href="/";//去到首页
                }else{
                    layer.alert(result.message,{icon:2});
                }
            },"json");
            //禁止表单提交后页面刷新
            return false;
        });
    });
</script>
</body>
</html>